<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Binary Search Example</title>
    <script>
      function hitCharBinSearch(mClientX, inmostHitEl) {
        // Your function code goes here
        // ...
      }
    </script>
  </head>
  <body>
    <p id="my-paragraph">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis a turpis et mauris maximus vestibulum eu vel elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis a turpis et mauris maximus vestibulum eu vel elit. Nam vehicula nibh vel urn, a posuere eros blandit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis a turpis et mauris maximus vestibulum eu vel elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis a turpis et mauris maximus vestibulum eu vel elit. Nam vehicula nibh vel urn, a posuere eros blandit.</p>

    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis a turpis et mauris maximus vestibulum eu vel elit. Nam vehicula nibh vel urna interdum scelerisque. Nullam non neque sit amet mauris malesuada vestibulum a a orci. Praesent tincidunt justo non quam consectetur, non facilisis turpis varius. Donec porttitor arcu sed orci aliquet, a posuere eros blandit.
    </p>
    <script>
      const tags = document.querySelectorAll('p');

      tags.forEach(tag => {

      tag.addEventListener("click", (event) => {
        const mousePosition = {
          x: event.clientX,
          y: event.clientY
        };
        const clickedElement = event.target;

        const charIndexOther = binBoys(mousePosition, clickedElement);
        console.log(`Clicked character index: ${charIndexOther}`);
      });
      })

function binBoys(cursorPos, target, charsOnRight = 0) {
  let len = target.textContent.length;
  let splitInd = len / 2;
  
  if (len === 0 || len === 1) return charsOnRight;

  let newNode = document.createElement("span");
  let textNodeR = target.firstChild.splitText(splitInd);
  let textNodeL = target.firstChild;

  let spanL = document.createElement("span");
  spanL.appendChild(textNodeL);
  spanL.style = "background-color:cyan;";
  let spanR = document.createElement("span");
  spanR.style = "background-color:yellow;";
  spanR.appendChild(textNodeR);

  newNode.appendChild(spanL);
  newNode.appendChild(spanR);

  target.replaceWith(newNode);
  
  const clientRects = newNode.getClientRects();
  let rowIndex = -1;
  for (let i = 0; i < clientRects.length; i++) {
    if (cursorPos.y >= clientRects[i].top && cursorPos.y < clientRects[i].bottom) {
      rowIndex = i;
      break;
    }
  }
  if (rowIndex === -1) {
    // Mouse click is outside the target element
    return -1;
  }
  
  const spanRBB = spanR.getBoundingClientRect();
  if (cursorPos.x >= spanRBB.left) {
    charsOnRight += spanL.textContent.length;
    return charsOnRight + binBoys(cursorPos, spanR, charsOnRight);
  } else {
    return charsOnRight + binBoys(cursorPos, spanL, charsOnRight);
  }
}
    </script>
  </body>
</html>

